setwd("~/Desktop/filter")
test <- read.table("fcfb8d34-e193-47a9-b88c-0bf8f247d942.snpEff.vcf.gz.hg38_multianno.txt", sep = "\t", header = T, col.names = c("Chr", "Start", "End", "Ref", "Alt", "Function", "Gene", "GeneDetail", "ExonicFunction", "AAChange", "InterVar_automated", "PVS1", "PS1", "PS2", "PS3", "PS4", "PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PP1", "PP2", "PP3", "PP4", "PP5", "BA1", "BS1", "BS2", "BS3", "BS4", "BP1", "BP2", "BP3", "BP4", "BP5", "BP6", "BP7", "abraom_freq", "abraom_filter", "abraom_cegh_filter", "nci60", "Kaviar_AF", "Kaviar_AC", "Kaviar_AN", "HRC_AF", "HRC_AC", "HRC_AN", "HRC_non1000G_AF", "HRC_non1000G_AC", "HRC_non1000G_AN", "gnomad_exome_AF", "gnomad_exome_AF_popmax", "gnomad_exome_AF_male", "gnomad_exome_AF_female", "gnomad_exome_AF_raw", "gnomad_exome_AF_afr", "gnomad_exome_AF_sas", "gnomad_exome_AF_amr", "gnomad_exome_AF_eas", "gnomad_exome_AF_nfe", "gnomad_exome_AF_fin", "gnomad_exome_AF_asj", "gnomad_exome_AF_oth", "gnomad_exome_non_topmed_AF_popmax", "gnomad_exome_non_neuro_AF_popmax", "gnomad_exome_non_cancer_AF_popmax", "gnomad_exome_controls_AF_popmax", "gnomad_genome_AF", "gnomad_genome_AF_popmax", "gnomad_genome_AF_male", "gnomad_genome_AF_female", "gnomad_genome_AF_raw", "gnomad_genome_AF_afr", "gnomad_genome_AF_sas", "gnomad_genome_AF_amr", "gnomad_genome_AF_eas", "gnomad_genome_AF_nfe", "gnomad_genome_AF_fin", "gnomad_genome_AF_asj", "gnomad_genome_AF_oth", "gnomad_genome_non_topmed_AF_popmax", "gnomad_genome_non_neuro_AF_popmax", "gnomad_genome_non_cancer_AF_popmax", "gnomad_genome_controls_AF_popmax", "SIFT_score", "SIFT_converted_rankscore", "SIFT_pred", "Polyphen2_HDIV_score", "Polyphen2_HDIV_rankscore", "Polyphen2_HDIV_pred", "Polyphen2_HVAR_score", "Polyphen2_HVAR_rankscore", "Polyphen2_HVAR_pred", "LRT_score", "LRT_converted_rankscore", "LRT_pred", "MutationTaster_score", "MutationTaster_converted_rankscore", "MutationTaster_pred", "MutationAssessor_score", "MutationAssessor_score_rankscore", "MutationAssessor_pred", "FATHMM_score", "FATHMM_converted_rankscore", "FATHMM_pred", "PROVEAN_score", "PROVEAN_converted_rankscore", "PROVEAN_pred", "VEST3_score", "VEST3_rankscore", "MetaSVM_score", "MetaSVM_rankscore", "MetaSVM_pred", "MetaLR_score", "MetaLR_rankscore", "MetaLR_pred", "M-CAP_score", "M-CAP_rankscore", "M-CAP_pred", "REVEL_score", "REVEL_rankscore", "MutPred_score", "MutPred_rankscore", "CADD_raw", "CADD_raw_rankscore", "CADD_phred", "DANN_score", "DANN_rankscore", "fathmm-MKL_coding_score", "fathmm-MKL_coding_rankscore", "fathmm-MKL_coding_pred", "Eigen_coding_or_noncoding", "Eigen-raw", "Eigen-PC-raw", "GenoCanyon_score", "GenoCanyon_score_rankscore", "integrated_fitCons_score", "integrated_fitCons_score_rankscore", "integrated_confidence_value", "GERP++_RS", "GERP++_RS_rankscore", "phyloP100way_vertebrate", "phyloP100way_vertebrate_rankscore", "phyloP20way_mammalian", "phyloP20way_mammalian_rankscore", "phastCons100way_vertebrate", "phastCons100way_vertebrate_rankscore", "phastCons20way_mammalian", "phastCons20way_mammalian_rankscore", "SiPhy_29way_logOdds", "SiPhy_29way_logOdds_rankscore", "Interpro_domain", "GTEx_V6p_gene", "GTEx_V6p_tissue", "avsnp150", "CLNALLELEID", "CLNDN", "CLNDISDB", "CLNREVSTAT", "CLNSIG", "dbscSNV_ADA_SCORE", "dbscSNV_RF_SCORE", "GME_AF", "GME_NWA", "GME_NEA", "GME_AP", "GME_Israel", "GME_SD", "GME_TP", "GME_CA", "regsnp_fpr", "regsnp_disease", "regsnp_splicing_site", "cosmic89_coding", "cosmic89_noncoding", "allele_fract", "quality1", "read_depth", "chrom", "pos", "rsid", "ref-", "alt-", "quality2", "filter", "info1", "info_headers", "info2"))
test <- read.table("xaa", sep = "\t", header = T, col.names = c("Chr", "Start", "End", "Ref", "Alt", "Function", "Gene", "GeneDetail", "ExonicFunction", "AAChange", "InterVar_automated", "PVS1", "PS1", "PS2", "PS3", "PS4", "PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PP1", "PP2", "PP3", "PP4", "PP5", "BA1", "BS1", "BS2", "BS3", "BS4", "BP1", "BP2", "BP3", "BP4", "BP5", "BP6", "BP7", "abraom_freq", "abraom_filter", "abraom_cegh_filter", "nci60", "Kaviar_AF", "Kaviar_AC", "Kaviar_AN", "HRC_AF", "HRC_AC", "HRC_AN", "HRC_non1000G_AF", "HRC_non1000G_AC", "HRC_non1000G_AN", "gnomad_exome_AF", "gnomad_exome_AF_popmax", "gnomad_exome_AF_male", "gnomad_exome_AF_female", "gnomad_exome_AF_raw", "gnomad_exome_AF_afr", "gnomad_exome_AF_sas", "gnomad_exome_AF_amr", "gnomad_exome_AF_eas", "gnomad_exome_AF_nfe", "gnomad_exome_AF_fin", "gnomad_exome_AF_asj", "gnomad_exome_AF_oth", "gnomad_exome_non_topmed_AF_popmax", "gnomad_exome_non_neuro_AF_popmax", "gnomad_exome_non_cancer_AF_popmax", "gnomad_exome_controls_AF_popmax", "gnomad_genome_AF", "gnomad_genome_AF_popmax", "gnomad_genome_AF_male", "gnomad_genome_AF_female", "gnomad_genome_AF_raw", "gnomad_genome_AF_afr", "gnomad_genome_AF_sas", "gnomad_genome_AF_amr", "gnomad_genome_AF_eas", "gnomad_genome_AF_nfe", "gnomad_genome_AF_fin", "gnomad_genome_AF_asj", "gnomad_genome_AF_oth", "gnomad_genome_non_topmed_AF_popmax", "gnomad_genome_non_neuro_AF_popmax", "gnomad_genome_non_cancer_AF_popmax", "gnomad_genome_controls_AF_popmax", "SIFT_score", "SIFT_converted_rankscore", "SIFT_pred", "Polyphen2_HDIV_score", "Polyphen2_HDIV_rankscore", "Polyphen2_HDIV_pred", "Polyphen2_HVAR_score", "Polyphen2_HVAR_rankscore", "Polyphen2_HVAR_pred", "LRT_score", "LRT_converted_rankscore", "LRT_pred", "MutationTaster_score", "MutationTaster_converted_rankscore", "MutationTaster_pred", "MutationAssessor_score", "MutationAssessor_score_rankscore", "MutationAssessor_pred", "FATHMM_score", "FATHMM_converted_rankscore", "FATHMM_pred", "PROVEAN_score", "PROVEAN_converted_rankscore", "PROVEAN_pred", "VEST3_score", "VEST3_rankscore", "MetaSVM_score", "MetaSVM_rankscore", "MetaSVM_pred", "MetaLR_score", "MetaLR_rankscore", "MetaLR_pred", "M-CAP_score", "M-CAP_rankscore", "M-CAP_pred", "REVEL_score", "REVEL_rankscore", "MutPred_score", "MutPred_rankscore", "CADD_raw", "CADD_raw_rankscore", "CADD_phred", "DANN_score", "DANN_rankscore", "fathmm-MKL_coding_score", "fathmm-MKL_coding_rankscore", "fathmm-MKL_coding_pred", "Eigen_coding_or_noncoding", "Eigen-raw", "Eigen-PC-raw", "GenoCanyon_score", "GenoCanyon_score_rankscore", "integrated_fitCons_score", "integrated_fitCons_score_rankscore", "integrated_confidence_value", "GERP++_RS", "GERP++_RS_rankscore", "phyloP100way_vertebrate", "phyloP100way_vertebrate_rankscore", "phyloP20way_mammalian", "phyloP20way_mammalian_rankscore", "phastCons100way_vertebrate", "phastCons100way_vertebrate_rankscore", "phastCons20way_mammalian", "phastCons20way_mammalian_rankscore", "SiPhy_29way_logOdds", "SiPhy_29way_logOdds_rankscore", "Interpro_domain", "GTEx_V6p_gene", "GTEx_V6p_tissue", "avsnp150", "CLNALLELEID", "CLNDN", "CLNDISDB", "CLNREVSTAT", "CLNSIG", "dbscSNV_ADA_SCORE", "dbscSNV_RF_SCORE", "GME_AF", "GME_NWA", "GME_NEA", "GME_AP", "GME_Israel", "GME_SD", "GME_TP", "GME_CA", "regsnp_fpr", "regsnp_disease", "regsnp_splicing_site", "cosmic89_coding", "cosmic89_noncoding", "allele_fract", "quality1", "read_depth", "chrom", "pos", "rsid", "ref-", "alt-", "quality2", "filter", "info1", "info_headers", "info2"))
View(test)
test1 <- test
test2 <- read.table("xab", sep = "\t", header = T, col.names = c("Chr", "Start", "End", "Ref", "Alt", "Function", "Gene", "GeneDetail", "ExonicFunction", "AAChange", "InterVar_automated", "PVS1", "PS1", "PS2", "PS3", "PS4", "PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PP1", "PP2", "PP3", "PP4", "PP5", "BA1", "BS1", "BS2", "BS3", "BS4", "BP1", "BP2", "BP3", "BP4", "BP5", "BP6", "BP7", "abraom_freq", "abraom_filter", "abraom_cegh_filter", "nci60", "Kaviar_AF", "Kaviar_AC", "Kaviar_AN", "HRC_AF", "HRC_AC", "HRC_AN", "HRC_non1000G_AF", "HRC_non1000G_AC", "HRC_non1000G_AN", "gnomad_exome_AF", "gnomad_exome_AF_popmax", "gnomad_exome_AF_male", "gnomad_exome_AF_female", "gnomad_exome_AF_raw", "gnomad_exome_AF_afr", "gnomad_exome_AF_sas", "gnomad_exome_AF_amr", "gnomad_exome_AF_eas", "gnomad_exome_AF_nfe", "gnomad_exome_AF_fin", "gnomad_exome_AF_asj", "gnomad_exome_AF_oth", "gnomad_exome_non_topmed_AF_popmax", "gnomad_exome_non_neuro_AF_popmax", "gnomad_exome_non_cancer_AF_popmax", "gnomad_exome_controls_AF_popmax", "gnomad_genome_AF", "gnomad_genome_AF_popmax", "gnomad_genome_AF_male", "gnomad_genome_AF_female", "gnomad_genome_AF_raw", "gnomad_genome_AF_afr", "gnomad_genome_AF_sas", "gnomad_genome_AF_amr", "gnomad_genome_AF_eas", "gnomad_genome_AF_nfe", "gnomad_genome_AF_fin", "gnomad_genome_AF_asj", "gnomad_genome_AF_oth", "gnomad_genome_non_topmed_AF_popmax", "gnomad_genome_non_neuro_AF_popmax", "gnomad_genome_non_cancer_AF_popmax", "gnomad_genome_controls_AF_popmax", "SIFT_score", "SIFT_converted_rankscore", "SIFT_pred", "Polyphen2_HDIV_score", "Polyphen2_HDIV_rankscore", "Polyphen2_HDIV_pred", "Polyphen2_HVAR_score", "Polyphen2_HVAR_rankscore", "Polyphen2_HVAR_pred", "LRT_score", "LRT_converted_rankscore", "LRT_pred", "MutationTaster_score", "MutationTaster_converted_rankscore", "MutationTaster_pred", "MutationAssessor_score", "MutationAssessor_score_rankscore", "MutationAssessor_pred", "FATHMM_score", "FATHMM_converted_rankscore", "FATHMM_pred", "PROVEAN_score", "PROVEAN_converted_rankscore", "PROVEAN_pred", "VEST3_score", "VEST3_rankscore", "MetaSVM_score", "MetaSVM_rankscore", "MetaSVM_pred", "MetaLR_score", "MetaLR_rankscore", "MetaLR_pred", "M-CAP_score", "M-CAP_rankscore", "M-CAP_pred", "REVEL_score", "REVEL_rankscore", "MutPred_score", "MutPred_rankscore", "CADD_raw", "CADD_raw_rankscore", "CADD_phred", "DANN_score", "DANN_rankscore", "fathmm-MKL_coding_score", "fathmm-MKL_coding_rankscore", "fathmm-MKL_coding_pred", "Eigen_coding_or_noncoding", "Eigen-raw", "Eigen-PC-raw", "GenoCanyon_score", "GenoCanyon_score_rankscore", "integrated_fitCons_score", "integrated_fitCons_score_rankscore", "integrated_confidence_value", "GERP++_RS", "GERP++_RS_rankscore", "phyloP100way_vertebrate", "phyloP100way_vertebrate_rankscore", "phyloP20way_mammalian", "phyloP20way_mammalian_rankscore", "phastCons100way_vertebrate", "phastCons100way_vertebrate_rankscore", "phastCons20way_mammalian", "phastCons20way_mammalian_rankscore", "SiPhy_29way_logOdds", "SiPhy_29way_logOdds_rankscore", "Interpro_domain", "GTEx_V6p_gene", "GTEx_V6p_tissue", "avsnp150", "CLNALLELEID", "CLNDN", "CLNDISDB", "CLNREVSTAT", "CLNSIG", "dbscSNV_ADA_SCORE", "dbscSNV_RF_SCORE", "GME_AF", "GME_NWA", "GME_NEA", "GME_AP", "GME_Israel", "GME_SD", "GME_TP", "GME_CA", "regsnp_fpr", "regsnp_disease", "regsnp_splicing_site", "cosmic89_coding", "cosmic89_noncoding", "allele_fract", "quality1", "read_depth", "chrom", "pos", "rsid", "ref-", "alt-", "quality2", "filter", "info1", "info_headers", "info2"))
rm(test)
test1 <-separate(test1, info2 ,sep=":", c("genotype","allelic_depth","read_depth2","genotype_quality","phred_likelihoods"))
test1 <-separate(test1, info1, sep= "\\|", c("random", "Variant_Classification"), remove = F)
test1 <- separate(test1, allelic_depth, sep= "," , c("refnum", "altnum"), remove = F)
test1$allele_fraction <- (as.numeric(test1$altnum)/(as.numeric(test1$refnum)+as.numeric(test1$altnum)))
test1 <- cbind(test1[7], test1[183], test1[1:6], test1[9], test1[180], test1[187], test1[199], test1[179],test1[10:178], test1[193:194], test1[188])
test1 <- test1[as.numeric(test1$read_depth)>4 & test1$allele_fraction>0.15 & as.character(test1$filter)=="PASS",]
test1 <- test1[-grep("[.]", test1$ExonicFunction),]
library(tidyverse)
test2 <-separate(test2, info2 ,sep=":", c("genotype","allelic_depth","read_depth2","genotype_quality","phred_likelihoods"))
test2 <-separate(test2, info1, sep= "\\|", c("random", "Variant_Classification"), remove = F)
test2 <- separate(test2, allelic_depth, sep= "," , c("refnum", "altnum"), remove = F)
test2$allele_fraction <- (as.numeric(test2$altnum)/(as.numeric(test2$refnum)+as.numeric(test2$altnum)))
test2 <- cbind(test2[7], test2[183], test2[1:6], test2[9], test2[180], test2[187], test2[199], test2[179],test2[10:178], test2[193:194], test2[188])
test2 <- test2[as.numeric(test2$read_depth)>4 & test2$allele_fraction>0.15 & as.character(test2$filter)=="PASS",]
test2 <- test2[-grep("[.]", test2$ExonicFunction),]
test2 <- test2[-grep("[.]", test2$ExonicFunction),]
testa <- read.table("xaa", sep = "\t", header = T, col.names = c("Chr", "Start", "End", "Ref", "Alt", "Function", "Gene", "GeneDetail", "ExonicFunction", "AAChange", "InterVar_automated", "PVS1", "PS1", "PS2", "PS3", "PS4", "PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PP1", "PP2", "PP3", "PP4", "PP5", "BA1", "BS1", "BS2", "BS3", "BS4", "BP1", "BP2", "BP3", "BP4", "BP5", "BP6", "BP7", "abraom_freq", "abraom_filter", "abraom_cegh_filter", "nci60", "Kaviar_AF", "Kaviar_AC", "Kaviar_AN", "HRC_AF", "HRC_AC", "HRC_AN", "HRC_non1000G_AF", "HRC_non1000G_AC", "HRC_non1000G_AN", "gnomad_exome_AF", "gnomad_exome_AF_popmax", "gnomad_exome_AF_male", "gnomad_exome_AF_female", "gnomad_exome_AF_raw", "gnomad_exome_AF_afr", "gnomad_exome_AF_sas", "gnomad_exome_AF_amr", "gnomad_exome_AF_eas", "gnomad_exome_AF_nfe", "gnomad_exome_AF_fin", "gnomad_exome_AF_asj", "gnomad_exome_AF_oth", "gnomad_exome_non_topmed_AF_popmax", "gnomad_exome_non_neuro_AF_popmax", "gnomad_exome_non_cancer_AF_popmax", "gnomad_exome_controls_AF_popmax", "gnomad_genome_AF", "gnomad_genome_AF_popmax", "gnomad_genome_AF_male", "gnomad_genome_AF_female", "gnomad_genome_AF_raw", "gnomad_genome_AF_afr", "gnomad_genome_AF_sas", "gnomad_genome_AF_amr", "gnomad_genome_AF_eas", "gnomad_genome_AF_nfe", "gnomad_genome_AF_fin", "gnomad_genome_AF_asj", "gnomad_genome_AF_oth", "gnomad_genome_non_topmed_AF_popmax", "gnomad_genome_non_neuro_AF_popmax", "gnomad_genome_non_cancer_AF_popmax", "gnomad_genome_controls_AF_popmax", "SIFT_score", "SIFT_converted_rankscore", "SIFT_pred", "Polyphen2_HDIV_score", "Polyphen2_HDIV_rankscore", "Polyphen2_HDIV_pred", "Polyphen2_HVAR_score", "Polyphen2_HVAR_rankscore", "Polyphen2_HVAR_pred", "LRT_score", "LRT_converted_rankscore", "LRT_pred", "MutationTaster_score", "MutationTaster_converted_rankscore", "MutationTaster_pred", "MutationAssessor_score", "MutationAssessor_score_rankscore", "MutationAssessor_pred", "FATHMM_score", "FATHMM_converted_rankscore", "FATHMM_pred", "PROVEAN_score", "PROVEAN_converted_rankscore", "PROVEAN_pred", "VEST3_score", "VEST3_rankscore", "MetaSVM_score", "MetaSVM_rankscore", "MetaSVM_pred", "MetaLR_score", "MetaLR_rankscore", "MetaLR_pred", "M-CAP_score", "M-CAP_rankscore", "M-CAP_pred", "REVEL_score", "REVEL_rankscore", "MutPred_score", "MutPred_rankscore", "CADD_raw", "CADD_raw_rankscore", "CADD_phred", "DANN_score", "DANN_rankscore", "fathmm-MKL_coding_score", "fathmm-MKL_coding_rankscore", "fathmm-MKL_coding_pred", "Eigen_coding_or_noncoding", "Eigen-raw", "Eigen-PC-raw", "GenoCanyon_score", "GenoCanyon_score_rankscore", "integrated_fitCons_score", "integrated_fitCons_score_rankscore", "integrated_confidence_value", "GERP++_RS", "GERP++_RS_rankscore", "phyloP100way_vertebrate", "phyloP100way_vertebrate_rankscore", "phyloP20way_mammalian", "phyloP20way_mammalian_rankscore", "phastCons100way_vertebrate", "phastCons100way_vertebrate_rankscore", "phastCons20way_mammalian", "phastCons20way_mammalian_rankscore", "SiPhy_29way_logOdds", "SiPhy_29way_logOdds_rankscore", "Interpro_domain", "GTEx_V6p_gene", "GTEx_V6p_tissue", "avsnp150", "CLNALLELEID", "CLNDN", "CLNDISDB", "CLNREVSTAT", "CLNSIG", "dbscSNV_ADA_SCORE", "dbscSNV_RF_SCORE", "GME_AF", "GME_NWA", "GME_NEA", "GME_AP", "GME_Israel", "GME_SD", "GME_TP", "GME_CA", "regsnp_fpr", "regsnp_disease", "regsnp_splicing_site", "cosmic89_coding", "cosmic89_noncoding", "allele_fract", "quality1", "read_depth", "chrom", "pos", "rsid", "ref-", "alt-", "quality2", "filter", "info1", "info_headers", "info2"))
testa <-separate(testa, info2 ,sep=":", c("genotype","allelic_depth","read_depth2","genotype_quality","phred_likelihoods"))
testa <-separate(testa, info1, sep= "\\|", c("random", "Variant_Classification"), remove = F)
testa <- separate(testa, allelic_depth, sep= "," , c("refnum", "altnum"), remove = F)
testa$allele_fraction <- (as.numeric(testa$altnum)/(as.numeric(testa$refnum)+as.numeric(testa$altnum)))
testa <- cbind(testa[7], testa[183], testa[1:6], testa[9], testa[180], testa[187], testa[199], testa[179],testa[10:178], testa[193:194], testa[188])
testa <- testa[as.numeric(testa$read_depth)>4 & testa$allele_fraction>0.15 & as.character(testa$filter)=="PASS",]
View(testa)
testa <- testa[-grep("[.]", testa$ExonicFunction),]
input_genes <- "predisposition-genes.txt"
genes <- read.delim(input_genes, header = F, sep = "", stringsAsFactors = F)
testa <- testa[is.element(testa$Gene,genes$V1), ]
rm(genes)
source('~/Desktop/filter/annovar-format.R')
source('~/Desktop/filter/annovar-format.R')
source('~/Desktop/filter/annovar-format.R')
View(testa)
View(testb)
View(testc)
source('~/Desktop/filter/annovar-format.R')
source('~/Desktop/filter/annovar-format.R')
all <- rbind(testa, testb, testc, testd, teste, testf)
View(all)
table(all$ExonicFunction)
table(all$Gene)
table(all$Chr)
intervar <- all[grep("pathogenic|uncertain",all$InterVar_automated),]
table(all$InterVar_automated)
table(all$CLNSIG)
thresholdfilter <- all[apply((all[,74:90] <= 0.001) | (is.na(all[,74:90])), 1, all),]
wanrings()
warnings()
all<- as.numeric(all[,48:90])
all[,48:90]<- as.numeric(all[,48:90])
all[,48:90]<- sapply(all[,48:90],as.numeric)
thresholdfilter <- all[apply((all[,74:90] <= 0.001) | (is.na(all[,74:90])), 1, all),]
all[all$gnomad_genome_AF<0.001]
all[all$gnomad_genome_AF<0.01]
all[all$gnomad_genome_AF<0.01,]
all[,all$gnomad_genome_AF<0.01]
str(all)
all <- rbind(testa, testb, testc, testd, teste, testf)
all[,48:90]<- sapply(all[,48:90],as.character)
str(all)
all <- rbind(testa, testb, testc, testd, teste, testf)
all[,48:90]<- sapply(all[,48:90],as.numeric(as.character))
str(all)
all <- rbind(testa, testb, testc, testd, teste, testf)
str(all)
all[,48:90]<- sapply(all[,48:90],as.character)
all[,48:90]<- sapply(all[,48:90],as.numeric)
warnings()
str(all)
all[,48:90]<- sapply(all[,48:90],as.numeric(as.character))
convert <- function(x) {
a <- as.numeric(as.character(x))
return(a)
}
all[,48:90]<- sapply(all[,48:90], FUN = convert)
test[,48:90]<- sapply(test[,48:90], FUN = convert)
all[,48:90]<- sapply(all[,48:90], FUN = convert)
all <- rbind(testa, testb, testc, testd, teste, testf)
str(all)
all[,48:90]<- sapply(all[,48:90], FUN = convert)
warnings()
str(all)
all[all$gnomad_genome_AF<0.01]
all[all$gnomad_genome_AF<0.01,]
thresholdfilter <- all[apply((all[,74:90] <= 0.001) | (is.na(all[,74:90])), 1, all),]
View(thresholdfilter)
intervar <- all[grep("pathogenic|uncertain",all$InterVar_automated),]
clinvar <- all[grep("pathogenic|uncertain", all$CLNSIG),]
intervar <- thresholdfilter[grep("pathogenic|uncertain",thresholdfilter$InterVar_automated),]
clinvar <- thresholdfilter[grep("pathogenic|uncertain", thresholdfilter$CLNSIG),]
intervar <- thresholdfilter[grep("pathogenic|uncertain",thresholdfilter$InterVar_automated, ignore.case = T),]
clinvar <- thresholdfilter[grep("pathogenic|uncertain", thresholdfilter$CLNSIG, ignore.case = T),]
merged <- rbind(clinvar, intervar)
merged <- unique(merged)
siftfilter <- thresholdfilter[grep("D", thresholdfilter$SIFT_pred, ignore.case = TRUE),]
lrtfilter <- thresholdfilter[grep("D", thresholdfilter$LRT_pred, ignore.case = TRUE),]
muttfilter <- thresholdfilter[grep("A|D", thresholdfilter$MutationTaster_pred, ignore.case = TRUE),]
mutafilter <- thresholdfilter[grep("H|M", thresholdfilter$MutationAssessor_pred, ignore.case = TRUE),]
pphdivfilter <- thresholdfilter[grep("D|P", thresholdfilter$Polyphen2_HDIV_pred, ignore.case = TRUE),]
metasvmfilter <- thresholdfilter[grep("D", thresholdfilter$MetaSVM_pred, ignore.case = TRUE),]
pphvarfilter <- thresholdfilter[grep("D|P", thresholdfilter$Polyphen2_HVAR_pred, ignore.case = TRUE),]
metalrfilter <- thresholdfilter[grep("D", thresholdfilter$MetaLR_pred, ignore.case = TRUE),]
mcapfilter <- thresholdfilter[grep("D", thresholdfilter$M.CAP_pred, ignore.case = TRUE),]
fathmmfilter <- thresholdfilter[grep("D", thresholdfilter$FATHMM_pred, ignore.case = TRUE),]
proveanfilter <- thresholdfilter[grep("D", thresholdfilter$PROVEAN_pred, ignore.case = TRUE),]
intervar <- thresholdfilter[grep("pathogenic|uncertain",thresholdfilter$InterVar_automated, ignore.case = T),]
clinvar <- thresholdfilter[grep("pathogenic|uncertain", thresholdfilter$CLNSIG, ignore.case = T),]
merged <- rbind(clinvarfilter, siftfilter,lrtfilter,muttfilter,pphdivfilter,pphvarfilter,metasvmfilter,metalrfilter,mcapfilter,fathmmfilter,proveanfilter,mutafilter)
merged <- rbind(clinvar, intervar, siftfilter,lrtfilter,muttfilter,pphdivfilter,pphvarfilter,metasvmfilter,metalrfilter,mcapfilter,fathmmfilter,proveanfilter,mutafilter)
merged <- unique(merged)
View(merged)
filter <- cbind(all$abraom_filter, all$filter)
afilter <- cbind(all$abraom_filter, all$filter)
View(afilter)
afilter <- cbind(as.character(all$abraom_filter), as.character(all$filter))
pbtahist <- read.delim("2019-06-07-pbta-histologies - 2019-06-07-pbta-hist-broad-mer.tsv", sep = "\t", stringsAsFactors = F)
pbtahist <- pbtahist[grep("diffuse", pbtahist$broad.histology, ignore.case = T),]
metadata <- read.csv("1562697453728-manifest.csv", stringsAsFactors = F)
participantfilt <- subset(metadata, metadata$Kids.First.Participant.ID %in% pbtahist$Kids.First.Participant.ID)
View(participantfilt)
participantfilt$Kids.First.Participant.ID
as.array(participantfilt$Kids.First.Participant.ID)
as.list(participantfilt$Kids.First.Participant.ID)
View(participantfilt$Kids.First.Participant.ID)
sink("participants.txt")
print(participantfilt$Kids.First.Participant.ID)
sink()
View(merged)
View(merged)
names(merged)[names(merged)== "Gene"] <- "Hugo_Symbol"
names(merged)[names(merged)== "Chr"] <- "Chromosome"
names(merged)[names(merged)== "Start"] <- "Start_Position"
names(merged)[names(merged)== "End"] <- "End_Position"
names(merged)[names(merged)== "ExonicFunction"] <- "Variant_Classification"
names(merged)[names(merged)== "Ref"] <- "Reference_Allele"
names(merged)[names(merged)== "Alt"] <- "Tumor_Seq_Allele2"
library(maftools)
sum <- read.maf(merged)
View(all)
for (i in 1:nrow(merged)) {
}
?annovarToMaf
for (i in 1:nrow(all)) {
if(Tumor_Seq_Allele2 == "-") {
all$Variant_Type[i] <- "DEL"
} else if (Reference_Allele == "-") {
all$Variant_Type[i] <- "INS"
} else {
all$Variant_Type[i] <- "SNP"
}
}
names(merged)[names(merged)== "Alt"] <- "Tumor_Seq_Allele2"
names(all)[names(all)== "Gene"] <- "Hugo_Symbol"
names(all)[names(all)== "Chr"] <- "Chromosome"
names(all)[names(all)== "Start"] <- "Start_Position"
names(all)[names(all)== "End"] <- "End_Position"
names(all)[names(all)== "ExonicFunction"] <- "Variant_Classification"
names(all)[names(all)== "Ref"] <- "Reference_Allele"
names(all)[names(all)== "Alt"] <- "Tumor_Seq_Allele2"
for (i in 1:nrow(all)) {
if(Tumor_Seq_Allele2 == "-") {
all$Variant_Type[i] <- "DEL"
} else if (Reference_Allele == "-") {
all$Variant_Type[i] <- "INS"
} else {
all$Variant_Type[i] <- "SNP"
}
}
for (i in 1:nrow(all)) {
if(Tumor_Seq_Allele2 == "-") {
all$Variant_Type[i] <- "DEL"
} else if (Reference_Allele == "-") {
all$Variant_Type[i] <- "INS"
} else {
all$Variant_Type[i] <- "SNP"
}
}
for (i in 1:nrow(all)) {
if(all$Tumor_Seq_Allele2 == "-") {
all$Variant_Type[i] <- "DEL"
} else if (all$Reference_Allele == "-") {
all$Variant_Type[i] <- "INS"
} else {
all$Variant_Type[i] <- "SNP"
}
}
warnings()
all <- rbind(testa, testb, testc, testd, teste, testf)
test <- read.table("xaf", sep = "\t", header = T, col.names = c("Chr", "Start", "End", "Ref", "Alt", "Func.refGene", "Gene.refGene", "GeneDetail.refGene", "ExonicFunc.refGene", "AAChange.refGene", "InterVar_automated", "PVS1", "PS1", "PS2", "PS3", "PS4", "PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PP1", "PP2", "PP3", "PP4", "PP5", "BA1", "BS1", "BS2", "BS3", "BS4", "BP1", "BP2", "BP3", "BP4", "BP5", "BP6", "BP7", "abraom_freq", "abraom_filter", "abraom_cegh_filter", "nci60", "Kaviar_AF", "Kaviar_AC", "Kaviar_AN", "HRC_AF", "HRC_AC", "HRC_AN", "HRC_non1000G_AF", "HRC_non1000G_AC", "HRC_non1000G_AN", "AF", "AF_popmax", "AF_male", "AF_female", "AF_raw", "AF_afr", "AF_sas", "AF_amr", "AF_eas", "AF_nfe", "AF_fin", "AF_asj", "AF_oth", "non_topmed_AF_popmax", "non_neuro_AF_popmax", "non_cancer_AF_popmax", "controls_AF_popmax", "AF", "AF_popmax", "AF_male", "AF_female", "AF_raw", "AF_afr", "AF_sas", "AF_amr", "AF_eas", "AF_nfe", "AF_fin", "AF_asj", "AF_oth", "non_topmed_AF_popmax", "non_neuro_AF_popmax", "non_cancer_AF_popmax", "controls_AF_popmax", "SIFT_score", "SIFT_converted_rankscore", "SIFT_pred", "Polyphen2_HDIV_score", "Polyphen2_HDIV_rankscore", "Polyphen2_HDIV_pred", "Polyphen2_HVAR_score", "Polyphen2_HVAR_rankscore", "Polyphen2_HVAR_pred", "LRT_score", "LRT_converted_rankscore", "LRT_pred", "MutationTaster_score", "MutationTaster_converted_rankscore", "MutationTaster_pred", "MutationAssessor_score", "MutationAssessor_score_rankscore", "MutationAssessor_pred", "FATHMM_score", "FATHMM_converted_rankscore", "FATHMM_pred", "PROVEAN_score", "PROVEAN_converted_rankscore", "PROVEAN_pred", "VEST3_score", "VEST3_rankscore", "MetaSVM_score", "MetaSVM_rankscore", "MetaSVM_pred", "MetaLR_score", "MetaLR_rankscore", "MetaLR_pred", "M-CAP_score", "M-CAP_rankscore", "M-CAP_pred", "REVEL_score", "REVEL_rankscore", "MutPred_score", "MutPred_rankscore", "CADD_raw", "CADD_raw_rankscore", "CADD_phred", "DANN_score", "DANN_rankscore", "fathmm-MKL_coding_score", "fathmm-MKL_coding_rankscore", "fathmm-MKL_coding_pred", "Eigen_coding_or_noncoding", "Eigen-raw", "Eigen-PC-raw", "GenoCanyon_score", "GenoCanyon_score_rankscore", "integrated_fitCons_score", "integrated_fitCons_score_rankscore", "integrated_confidence_value", "GERP++_RS", "GERP++_RS_rankscore", "phyloP100way_vertebrate", "phyloP100way_vertebrate_rankscore", "phyloP20way_mammalian", "phyloP20way_mammalian_rankscore", "phastCons100way_vertebrate", "phastCons100way_vertebrate_rankscore", "phastCons20way_mammalian", "phastCons20way_mammalian_rankscore", "SiPhy_29way_logOdds", "SiPhy_29way_logOdds_rankscore", "Interpro_domain", "GTEx_V6p_gene", "GTEx_V6p_tissue", "avsnp150", "CLNALLELEID", "CLNDN", "CLNDISDB", "CLNREVSTAT", "CLNSIG", "dbscSNV_ADA_SCORE", "dbscSNV_RF_SCORE", "GME_AF", "GME_NWA", "GME_NEA", "GME_AP", "GME_Israel", "GME_SD", "GME_TP", "GME_CA", "regsnp_fpr", "regsnp_disease", "regsnp_splicing_site", "cosmic89_coding", "cosmic89_noncoding", "Otherinfo"))
test <- read.table("xaa", sep = "\t", header = T, col.names = c("Chr", "Start", "End", "Ref", "Alt", "Func.refGene", "Gene.refGene", "GeneDetail.refGene", "ExonicFunc.refGene", "AAChange.refGene", "InterVar_automated", "PVS1", "PS1", "PS2", "PS3", "PS4", "PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PP1", "PP2", "PP3", "PP4", "PP5", "BA1", "BS1", "BS2", "BS3", "BS4", "BP1", "BP2", "BP3", "BP4", "BP5", "BP6", "BP7", "abraom_freq", "abraom_filter", "abraom_cegh_filter", "nci60", "Kaviar_AF", "Kaviar_AC", "Kaviar_AN", "HRC_AF", "HRC_AC", "HRC_AN", "HRC_non1000G_AF", "HRC_non1000G_AC", "HRC_non1000G_AN", "AF", "AF_popmax", "AF_male", "AF_female", "AF_raw", "AF_afr", "AF_sas", "AF_amr", "AF_eas", "AF_nfe", "AF_fin", "AF_asj", "AF_oth", "non_topmed_AF_popmax", "non_neuro_AF_popmax", "non_cancer_AF_popmax", "controls_AF_popmax", "AF", "AF_popmax", "AF_male", "AF_female", "AF_raw", "AF_afr", "AF_sas", "AF_amr", "AF_eas", "AF_nfe", "AF_fin", "AF_asj", "AF_oth", "non_topmed_AF_popmax", "non_neuro_AF_popmax", "non_cancer_AF_popmax", "controls_AF_popmax", "SIFT_score", "SIFT_converted_rankscore", "SIFT_pred", "Polyphen2_HDIV_score", "Polyphen2_HDIV_rankscore", "Polyphen2_HDIV_pred", "Polyphen2_HVAR_score", "Polyphen2_HVAR_rankscore", "Polyphen2_HVAR_pred", "LRT_score", "LRT_converted_rankscore", "LRT_pred", "MutationTaster_score", "MutationTaster_converted_rankscore", "MutationTaster_pred", "MutationAssessor_score", "MutationAssessor_score_rankscore", "MutationAssessor_pred", "FATHMM_score", "FATHMM_converted_rankscore", "FATHMM_pred", "PROVEAN_score", "PROVEAN_converted_rankscore", "PROVEAN_pred", "VEST3_score", "VEST3_rankscore", "MetaSVM_score", "MetaSVM_rankscore", "MetaSVM_pred", "MetaLR_score", "MetaLR_rankscore", "MetaLR_pred", "M-CAP_score", "M-CAP_rankscore", "M-CAP_pred", "REVEL_score", "REVEL_rankscore", "MutPred_score", "MutPred_rankscore", "CADD_raw", "CADD_raw_rankscore", "CADD_phred", "DANN_score", "DANN_rankscore", "fathmm-MKL_coding_score", "fathmm-MKL_coding_rankscore", "fathmm-MKL_coding_pred", "Eigen_coding_or_noncoding", "Eigen-raw", "Eigen-PC-raw", "GenoCanyon_score", "GenoCanyon_score_rankscore", "integrated_fitCons_score", "integrated_fitCons_score_rankscore", "integrated_confidence_value", "GERP++_RS", "GERP++_RS_rankscore", "phyloP100way_vertebrate", "phyloP100way_vertebrate_rankscore", "phyloP20way_mammalian", "phyloP20way_mammalian_rankscore", "phastCons100way_vertebrate", "phastCons100way_vertebrate_rankscore", "phastCons20way_mammalian", "phastCons20way_mammalian_rankscore", "SiPhy_29way_logOdds", "SiPhy_29way_logOdds_rankscore", "Interpro_domain", "GTEx_V6p_gene", "GTEx_V6p_tissue", "avsnp150", "CLNALLELEID", "CLNDN", "CLNDISDB", "CLNREVSTAT", "CLNSIG", "dbscSNV_ADA_SCORE", "dbscSNV_RF_SCORE", "GME_AF", "GME_NWA", "GME_NEA", "GME_AP", "GME_Israel", "GME_SD", "GME_TP", "GME_CA", "regsnp_fpr", "regsnp_disease", "regsnp_splicing_site", "cosmic89_coding", "cosmic89_noncoding", "Otherinfo"))
test <- read.table("xaa", sep = "\t", header = T, col.names = c("Chr", "Start", "End", "Ref", "Alt", "Func.refGene", "Gene.refGene", "GeneDetail.refGene", "ExonicFunc.refGene", "AAChange.refGene", "InterVar_automated", "PVS1", "PS1", "PS2", "PS3", "PS4", "PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PP1", "PP2", "PP3", "PP4", "PP5", "BA1", "BS1", "BS2", "BS3", "BS4", "BP1", "BP2", "BP3", "BP4", "BP5", "BP6", "BP7", "abraom_freq", "abraom_filter", "abraom_cegh_filter", "nci60", "Kaviar_AF", "Kaviar_AC", "Kaviar_AN", "HRC_AF", "HRC_AC", "HRC_AN", "HRC_non1000G_AF", "HRC_non1000G_AC", "HRC_non1000G_AN", "AF", "AF_popmax", "AF_male", "AF_female", "AF_raw", "AF_afr", "AF_sas", "AF_amr", "AF_eas", "AF_nfe", "AF_fin", "AF_asj", "AF_oth", "non_topmed_AF_popmax", "non_neuro_AF_popmax", "non_cancer_AF_popmax", "controls_AF_popmax", "AF", "AF_popmax", "AF_male", "AF_female", "AF_raw", "AF_afr", "AF_sas", "AF_amr", "AF_eas", "AF_nfe", "AF_fin", "AF_asj", "AF_oth", "non_topmed_AF_popmax", "non_neuro_AF_popmax", "non_cancer_AF_popmax", "controls_AF_popmax", "SIFT_score", "SIFT_converted_rankscore", "SIFT_pred", "Polyphen2_HDIV_score", "Polyphen2_HDIV_rankscore", "Polyphen2_HDIV_pred", "Polyphen2_HVAR_score", "Polyphen2_HVAR_rankscore", "Polyphen2_HVAR_pred", "LRT_score", "LRT_converted_rankscore", "LRT_pred", "MutationTaster_score", "MutationTaster_converted_rankscore", "MutationTaster_pred", "MutationAssessor_score", "MutationAssessor_score_rankscore", "MutationAssessor_pred", "FATHMM_score", "FATHMM_converted_rankscore", "FATHMM_pred", "PROVEAN_score", "PROVEAN_converted_rankscore", "PROVEAN_pred", "VEST3_score", "VEST3_rankscore", "MetaSVM_score", "MetaSVM_rankscore", "MetaSVM_pred", "MetaLR_score", "MetaLR_rankscore", "MetaLR_pred", "M-CAP_score", "M-CAP_rankscore", "M-CAP_pred", "REVEL_score", "REVEL_rankscore", "MutPred_score", "MutPred_rankscore", "CADD_raw", "CADD_raw_rankscore", "CADD_phred", "DANN_score", "DANN_rankscore", "fathmm-MKL_coding_score", "fathmm-MKL_coding_rankscore", "fathmm-MKL_coding_pred", "Eigen_coding_or_noncoding", "Eigen-raw", "Eigen-PC-raw", "GenoCanyon_score", "GenoCanyon_score_rankscore", "integrated_fitCons_score", "integrated_fitCons_score_rankscore", "integrated_confidence_value", "GERP++_RS", "GERP++_RS_rankscore", "phyloP100way_vertebrate", "phyloP100way_vertebrate_rankscore", "phyloP20way_mammalian", "phyloP20way_mammalian_rankscore", "phastCons100way_vertebrate", "phastCons100way_vertebrate_rankscore", "phastCons20way_mammalian", "phastCons20way_mammalian_rankscore", "SiPhy_29way_logOdds", "SiPhy_29way_logOdds_rankscore", "Interpro_domain", "GTEx_V6p_gene", "GTEx_V6p_tissue", "avsnp150", "CLNALLELEID", "CLNDN", "CLNDISDB", "CLNREVSTAT", "CLNSIG", "dbscSNV_ADA_SCORE", "dbscSNV_RF_SCORE", "GME_AF", "GME_NWA", "GME_NEA", "GME_AP", "GME_Israel", "GME_SD", "GME_TP", "GME_CA", "regsnp_fpr", "regsnp_disease", "regsnp_splicing_site", "cosmic89_coding", "cosmic89_noncoding", "Otherinfo1", "Otherinfo2", "Otherinfo3", "Otherinfo4", "Otherinfo5", "Otherinfo6", "Otherinfo7", "Otherinfo8", "Otherinfo9", "Otherinfo10", "Otherinfo11", "Otherinfo12", "Otherinfo13"))
View(test)
annovarToMaf(test)
annovarToMaf("xaa")
testmaf <- annovarToMaf("xaa")
View(testmaf)
testmaf <-separate(test, V190 ,sep=":", c("genotype","allelic_depth","read_depth2","genotype_quality","phred_likelihoods"))
testmaf <-separate(testmaf, V190 ,sep=":", c("genotype","allelic_depth","read_depth2","genotype_quality","phred_likelihoods"))
testmaf <- as.data.frame(testmaf)
testmaf <-separate(testmaf, V190 ,sep=":", c("genotype","allelic_depth","read_depth2","genotype_quality","phred_likelihoods"))
testmaf <- separate(testmaf, allelic_depth, sep= "," , c("refnum", "altnum"), remove = F)
colnames(testmaf) <- make.unique(names(testmaf))
testmaf <-separate(testmaf, V190 ,sep=":", c("genotype","allelic_depth","read_depth2","genotype_quality","phred_likelihoods"))
testmaf <- separate(testmaf, allelic_depth, sep= "," , c("refnum", "altnum"), remove = F)
test$allele_fraction <- (as.numeric(test$altnum)/(as.numeric(test$refnum)+as.numeric(test$altnum)))
rm(test)
testmaf$allele_fraction <- (as.numeric(testmaf$altnum)/(as.numeric(testmaf$refnum)+as.numeric(testmaf$altnum)))
test <- cbind(testmaf[7], testmaf[2:6], testmaf[191], testmaf[195], testmaf[203], testmaf[205], testmaf[8:14], testmaf[17:47], testmaf[51:185])
View(test)
test <- cbind(testmaf[7], testmaf[2:6], testmaf[191], testmaf[195], testmaf[202:203], testmaf[205], testmaf[8:14], testmaf[17:47], testmaf[51:185], testmaf[196], testmaf[198:201])
rm(testa)
rm(testb)
rm(testc)
rm(testd)
rm(teste)
rm(testf)
rm(filter)
colnames(test) <- c("Hugo_Symbol" "Chromosome", "Start_Position", "End_Position", "Reference_Allele", "Tumor_Seq_Allele2", "rsID", "FILTER", "read_depth", "quality", "allele_fraction", "Variant_Classification", "tx", "exon", "txChange", "aaChange", "Variant_Type", "Func.refGene", "ExonicFunc.refGene", "AAChange.refgene", "InterVar_automated", "PVS1", "PS1", "PS2", "PS3", "PS4", "PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PP1", "PP2", "PP3", "PP4", "PP5", "BA1", "BS1", "BS2", "BS3", "BS4", "BP1", "BP2", "BP3", "BP4", "BP5", "BP6", "BP7", "nci60", "Kaviar_AF", "Kaviar_AC", "Kaviar_AN", "HRC_AF", "HRC_AC", "HRC_AN", "HRC_non1000G_AF", "HRC_non1000G_AC", "HRC_non1000G_AN", "gnomad_exome_AF", "gnomad_exome_AF_popmax", "gnomad_exome_AF_male", "gnomad_exome_AF_female", "gnomad_exome_AF_raw", "gnomad_exome_AF_afr", "gnomad_exome_AF_sas", "gnomad_exome_AF_amr", "gnomad_exome_AF_eas", "gnomad_exome_AF_nfe", "gnomad_exome_AF_fin", "gnomad_exome_AF_asj", "gnomad_exome_AF_oth", "gnomad_exome_non_topmed_AF_popmax", "gnomad_exome_non_neuro_AF_popmax", "gnomad_exome_non_cancer_AF_popmax", "gnomad_exome_controls_AF_popmax", "gnomad_genome_AF", "gnomad_genome_AF_popmax", "gnomad_genome_AF_male", "gnomad_genome_AF_female", "gnomad_genome_AF_raw", "gnomad_genome_AF_afr", "gnomad_genome_AF_sas", "gnomad_genome_AF_amr", "gnomad_genome_AF_eas", "gnomad_genome_AF_nfe", "gnomad_genome_AF_fin", "gnomad_genome_AF_asj", "gnomad_genome_AF_oth", "gnomad_genome_non_topmed_AF_popmax", "gnomad_genome_non_neuro_AF_popmax", "gnomad_genome_non_cancer_AF_popmax", "gnomad_genome_controls_AF_popmax", "SIFT_score", "SIFT_converted_rankscore", "SIFT_pred", "Polyphen2_HDIV_score", "Polyphen2_HDIV_rankscore", "Polyphen2_HDIV_pred", "Polyphen2_HVAR_score", "Polyphen2_HVAR_rankscore", "Polyphen2_HVAR_pred", "LRT_score", "LRT_converted_rankscore", "LRT_pred", "MutationTaster_score", "MutationTaster_converted_rankscore", "MutationTaster_pred", "MutationAssessor_score", "MutationAssessor_score_rankscore", "MutationAssessor_pred", "FATHMM_score", "FATHMM_converted_rankscore", "FATHMM_pred", "PROVEAN_score", "PROVEAN_converted_rankscore", "PROVEAN_pred", "VEST3_score", "VEST3_rankscore", "MetaSVM_score", "MetaSVM_rankscore", "MetaSVM_pred", "MetaLR_score", "MetaLR_rankscore", "MetaLR_pred", "M-CAP_score", "M-CAP_rankscore", "M-CAP_pred", "REVEL_score", "REVEL_rankscore", "MutPred_score", "MutPred_rankscore", "CADD_raw", "CADD_raw_rankscore", "CADD_phred", "DANN_score", "DANN_rankscore", "fathmm-MKL_coding_score", "fathmm-MKL_coding_rankscore", "fathmm-MKL_coding_pred", "Eigen_coding_or_noncoding", "Eigen-raw", "Eigen-PC-raw", "GenoCanyon_score", "GenoCanyon_score_rankscore", "integrated_fitCons_score", "integrated_fitCons_score_rankscore", "integrated_confidence_value", "GERP++_RS", "GERP++_RS_rankscore", "phyloP100way_vertebrate", "phyloP100way_vertebrate_rankscore", "phyloP20way_mammalian", "phyloP20way_mammalian_rankscore", "phastCons100way_vertebrate", "phastCons100way_vertebrate_rankscore", "phastCons20way_mammalian", "phastCons20way_mammalian_rankscore", "SiPhy_29way_logOdds", "SiPhy_29way_logOdds_rankscore", "Interpro_domain", "GTEx_V6p_gene", "GTEx_V6p_tissue", "avsnp150", "CLNALLELEID", "CLNDN", "CLNDISDB", "CLNREVSTAT", "CLNSIG", "dbscSNV_ADA_SCORE", "dbscSNV_RF_SCORE", "GME_AF", "GME_NWA", "GME_NEA", "GME_AP", "GME_Israel", "GME_SD", "GME_TP", "GME_CA", "regsnp_fpr", "regsnp_disease", "regsnp_splicing_site", "cosmic89_coding", "cosmic89_noncoding", "info", "genotype", "allelic_depth", "refnum", "altnum")
colnames(test) <- c("Hugo_Symbol", "Chromosome", "Start_Position", "End_Position", "Reference_Allele", "Tumor_Seq_Allele2", "rsID", "FILTER", "read_depth", "quality", "allele_fraction", "Variant_Classification", "tx", "exon", "txChange", "aaChange", "Variant_Type", "Func.refGene", "ExonicFunc.refGene", "AAChange.refgene", "InterVar_automated", "PVS1", "PS1", "PS2", "PS3", "PS4", "PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PP1", "PP2", "PP3", "PP4", "PP5", "BA1", "BS1", "BS2", "BS3", "BS4", "BP1", "BP2", "BP3", "BP4", "BP5", "BP6", "BP7", "nci60", "Kaviar_AF", "Kaviar_AC", "Kaviar_AN", "HRC_AF", "HRC_AC", "HRC_AN", "HRC_non1000G_AF", "HRC_non1000G_AC", "HRC_non1000G_AN", "gnomad_exome_AF", "gnomad_exome_AF_popmax", "gnomad_exome_AF_male", "gnomad_exome_AF_female", "gnomad_exome_AF_raw", "gnomad_exome_AF_afr", "gnomad_exome_AF_sas", "gnomad_exome_AF_amr", "gnomad_exome_AF_eas", "gnomad_exome_AF_nfe", "gnomad_exome_AF_fin", "gnomad_exome_AF_asj", "gnomad_exome_AF_oth", "gnomad_exome_non_topmed_AF_popmax", "gnomad_exome_non_neuro_AF_popmax", "gnomad_exome_non_cancer_AF_popmax", "gnomad_exome_controls_AF_popmax", "gnomad_genome_AF", "gnomad_genome_AF_popmax", "gnomad_genome_AF_male", "gnomad_genome_AF_female", "gnomad_genome_AF_raw", "gnomad_genome_AF_afr", "gnomad_genome_AF_sas", "gnomad_genome_AF_amr", "gnomad_genome_AF_eas", "gnomad_genome_AF_nfe", "gnomad_genome_AF_fin", "gnomad_genome_AF_asj", "gnomad_genome_AF_oth", "gnomad_genome_non_topmed_AF_popmax", "gnomad_genome_non_neuro_AF_popmax", "gnomad_genome_non_cancer_AF_popmax", "gnomad_genome_controls_AF_popmax", "SIFT_score", "SIFT_converted_rankscore", "SIFT_pred", "Polyphen2_HDIV_score", "Polyphen2_HDIV_rankscore", "Polyphen2_HDIV_pred", "Polyphen2_HVAR_score", "Polyphen2_HVAR_rankscore", "Polyphen2_HVAR_pred", "LRT_score", "LRT_converted_rankscore", "LRT_pred", "MutationTaster_score", "MutationTaster_converted_rankscore", "MutationTaster_pred", "MutationAssessor_score", "MutationAssessor_score_rankscore", "MutationAssessor_pred", "FATHMM_score", "FATHMM_converted_rankscore", "FATHMM_pred", "PROVEAN_score", "PROVEAN_converted_rankscore", "PROVEAN_pred", "VEST3_score", "VEST3_rankscore", "MetaSVM_score", "MetaSVM_rankscore", "MetaSVM_pred", "MetaLR_score", "MetaLR_rankscore", "MetaLR_pred", "M-CAP_score", "M-CAP_rankscore", "M-CAP_pred", "REVEL_score", "REVEL_rankscore", "MutPred_score", "MutPred_rankscore", "CADD_raw", "CADD_raw_rankscore", "CADD_phred", "DANN_score", "DANN_rankscore", "fathmm-MKL_coding_score", "fathmm-MKL_coding_rankscore", "fathmm-MKL_coding_pred", "Eigen_coding_or_noncoding", "Eigen-raw", "Eigen-PC-raw", "GenoCanyon_score", "GenoCanyon_score_rankscore", "integrated_fitCons_score", "integrated_fitCons_score_rankscore", "integrated_confidence_value", "GERP++_RS", "GERP++_RS_rankscore", "phyloP100way_vertebrate", "phyloP100way_vertebrate_rankscore", "phyloP20way_mammalian", "phyloP20way_mammalian_rankscore", "phastCons100way_vertebrate", "phastCons100way_vertebrate_rankscore", "phastCons20way_mammalian", "phastCons20way_mammalian_rankscore", "SiPhy_29way_logOdds", "SiPhy_29way_logOdds_rankscore", "Interpro_domain", "GTEx_V6p_gene", "GTEx_V6p_tissue", "avsnp150", "CLNALLELEID", "CLNDN", "CLNDISDB", "CLNREVSTAT", "CLNSIG", "dbscSNV_ADA_SCORE", "dbscSNV_RF_SCORE", "GME_AF", "GME_NWA", "GME_NEA", "GME_AP", "GME_Israel", "GME_SD", "GME_TP", "GME_CA", "regsnp_fpr", "regsnp_disease", "regsnp_splicing_site", "cosmic89_coding", "cosmic89_noncoding", "info", "genotype", "allelic_depth", "refnum", "altnum")
send <- test[1:3,]
View(send)
saveRDS(send, "headings.RDS")
?saveaRDS
?saveRDS
send <- readRDS("headings.RDS")
View(send)
colnames(test) <- c("Hugo_Symbol", "Chromosome", "Start_Position", "End_Position", "Reference_Allele", "Tumor_Seq_Allele2", "rsID", "FILTER", "read_depth", "quality", "allele_fraction", "Variant_Classification", "tx", "exon", "txChange", "aaChange", "Variant_Type", "Func.refGene", "ExonicFunc.refGene", "AAChange.refgene", "InterVar_automated", "PVS1", "PS1", "PS2", "PS3", "PS4", "PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PP1", "PP2", "PP3", "PP4", "PP5", "BA1", "BS1", "BS2", "BS3", "BS4", "BP1", "BP2", "BP3", "BP4", "BP5", "BP6", "BP7", "nci60", "Kaviar_AF", "Kaviar_AC", "Kaviar_AN", "HRC_AF", "HRC_AC", "HRC_AN", "HRC_non1000G_AF", "HRC_non1000G_AC", "HRC_non1000G_AN", "gnomad_exome_AF", "gnomad_exome_AF_popmax", "gnomad_exome_AF_male", "gnomad_exome_AF_female", "gnomad_exome_AF_raw", "gnomad_exome_AF_afr", "gnomad_exome_AF_sas", "gnomad_exome_AF_amr", "gnomad_exome_AF_eas", "gnomad_exome_AF_nfe", "gnomad_exome_AF_fin", "gnomad_exome_AF_asj", "gnomad_exome_AF_oth", "gnomad_exome_non_topmed_AF_popmax", "gnomad_exome_non_neuro_AF_popmax", "gnomad_exome_non_cancer_AF_popmax", "gnomad_exome_controls_AF_popmax", "gnomad_genome_AF", "gnomad_genome_AF_popmax", "gnomad_genome_AF_male", "gnomad_genome_AF_female", "gnomad_genome_AF_raw", "gnomad_genome_AF_afr", "gnomad_genome_AF_sas", "gnomad_genome_AF_amr", "gnomad_genome_AF_eas", "gnomad_genome_AF_nfe", "gnomad_genome_AF_fin", "gnomad_genome_AF_asj", "gnomad_genome_AF_oth", "gnomad_genome_non_topmed_AF_popmax", "gnomad_genome_non_neuro_AF_popmax", "gnomad_genome_non_cancer_AF_popmax", "gnomad_genome_controls_AF_popmax", "SIFT_score", "SIFT_converted_rankscore", "SIFT_pred", "Polyphen2_HDIV_score", "Polyphen2_HDIV_rankscore", "Polyphen2_HDIV_pred", "Polyphen2_HVAR_score", "Polyphen2_HVAR_rankscore", "Polyphen2_HVAR_pred", "LRT_score", "LRT_converted_rankscore", "LRT_pred", "MutationTaster_score", "MutationTaster_converted_rankscore", "MutationTaster_pred", "MutationAssessor_score", "MutationAssessor_score_rankscore", "MutationAssessor_pred", "FATHMM_score", "FATHMM_converted_rankscore", "FATHMM_pred", "PROVEAN_score", "PROVEAN_converted_rankscore", "PROVEAN_pred", "VEST3_score", "VEST3_rankscore", "MetaSVM_score", "MetaSVM_rankscore", "MetaSVM_pred", "MetaLR_score", "MetaLR_rankscore", "MetaLR_pred", "M-CAP_score", "M-CAP_rankscore", "M-CAP_pred", "REVEL_score", "REVEL_rankscore", "MutPred_score", "MutPred_rankscore", "CADD_raw", "CADD_raw_rankscore", "CADD_phred", "DANN_score", "DANN_rankscore", "fathmm-MKL_coding_score", "fathmm-MKL_coding_rankscore", "fathmm-MKL_coding_pred", "Eigen_coding_or_noncoding", "Eigen-raw", "Eigen-PC-raw", "GenoCanyon_score", "GenoCanyon_score_rankscore", "integrated_fitCons_score", "integrated_fitCons_score_rankscore", "integrated_confidence_value", "GERP++_RS", "GERP++_RS_rankscore", "phyloP100way_vertebrate", "phyloP100way_vertebrate_rankscore", "phyloP20way_mammalian", "phyloP20way_mammalian_rankscore", "phastCons100way_vertebrate", "phastCons100way_vertebrate_rankscore", "phastCons20way_mammalian", "phastCons20way_mammalian_rankscore", "SiPhy_29way_logOdds", "SiPhy_29way_logOdds_rankscore", "Interpro_domain", "GTEx_V6p_gene", "GTEx_V6p_tissue", "avsnp150", "CLNALLELEID", "CLNDN", "CLNDISDB", "CLNREVSTAT", "CLNSIG", "dbscSNV_ADA_SCORE", "dbscSNV_RF_SCORE", "GME_AF", "GME_NWA", "GME_NEA", "GME_AP", "GME_Israel", "GME_SD", "GME_TP", "GME_CA", "regsnp_fpr", "regsnp_disease", "regsnp_splicing_site", "cosmic89_coding", "cosmic89_noncoding", "info", "genotype", "allelic_depth","ref_depth", "alt_depth")
library(sevenbridges)
a <- Auth(platform = "cavatica", token = "d8554e151de14d9b998af569994f4bfb")
p <- a$project(id = "gaonkark/sv-test")
file <- p$file(name = basename(fcfb8d34-e193-47a9-b88c-0bf8f247d942.snpEff.vcf.gz.hg38_multianno.txt), exact = TRUE)
file <- p$file(name = basename("fcfb8d34-e193-47a9-b88c-0bf8f247d942.snpEff.vcf.gz.hg38_multianno.txt"), exact = TRUE)
testmaf$Tumor_Sample_Barcode <- file$meta()$`Kids First Biospecimen ID`
testmaf$Tumor_Sample_Barcode <- file$meta()$`Kids First Biospecimen ID`
View(file)
colnames(testmaf) <- c("Hugo_Symbol", "Chromosome", "Start_Position", "End_Position", "Reference_Allele", "Tumor_Seq_Allele2", "rsID", "FILTER", "read_depth", "quality", "allele_fraction", "Variant_Classification", "tx", "exon", "txChange", "aaChange", "Variant_Type", "Func.refGene", "ExonicFunc.refGene", "AAChange.refgene", "InterVar_automated", "PVS1", "PS1", "PS2", "PS3", "PS4", "PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PP1", "PP2", "PP3", "PP4", "PP5", "BA1", "BS1", "BS2", "BS3", "BS4", "BP1", "BP2", "BP3", "BP4", "BP5", "BP6", "BP7", "nci60", "Kaviar_AF", "Kaviar_AC", "Kaviar_AN", "HRC_AF", "HRC_AC", "HRC_AN", "HRC_non1000G_AF", "HRC_non1000G_AC", "HRC_non1000G_AN", "gnomad_exome_AF", "gnomad_exome_AF_popmax", "gnomad_exome_AF_male", "gnomad_exome_AF_female", "gnomad_exome_AF_raw", "gnomad_exome_AF_afr", "gnomad_exome_AF_sas", "gnomad_exome_AF_amr", "gnomad_exome_AF_eas", "gnomad_exome_AF_nfe", "gnomad_exome_AF_fin", "gnomad_exome_AF_asj", "gnomad_exome_AF_oth", "gnomad_exome_non_topmed_AF_popmax", "gnomad_exome_non_neuro_AF_popmax", "gnomad_exome_non_cancer_AF_popmax", "gnomad_exome_controls_AF_popmax", "gnomad_genome_AF", "gnomad_genome_AF_popmax", "gnomad_genome_AF_male", "gnomad_genome_AF_female", "gnomad_genome_AF_raw", "gnomad_genome_AF_afr", "gnomad_genome_AF_sas", "gnomad_genome_AF_amr", "gnomad_genome_AF_eas", "gnomad_genome_AF_nfe", "gnomad_genome_AF_fin", "gnomad_genome_AF_asj", "gnomad_genome_AF_oth", "gnomad_genome_non_topmed_AF_popmax", "gnomad_genome_non_neuro_AF_popmax", "gnomad_genome_non_cancer_AF_popmax", "gnomad_genome_controls_AF_popmax", "SIFT_score", "SIFT_converted_rankscore", "SIFT_pred", "Polyphen2_HDIV_score", "Polyphen2_HDIV_rankscore", "Polyphen2_HDIV_pred", "Polyphen2_HVAR_score", "Polyphen2_HVAR_rankscore", "Polyphen2_HVAR_pred", "LRT_score", "LRT_converted_rankscore", "LRT_pred", "MutationTaster_score", "MutationTaster_converted_rankscore", "MutationTaster_pred", "MutationAssessor_score", "MutationAssessor_score_rankscore", "MutationAssessor_pred", "FATHMM_score", "FATHMM_converted_rankscore", "FATHMM_pred", "PROVEAN_score", "PROVEAN_converted_rankscore", "PROVEAN_pred", "VEST3_score", "VEST3_rankscore", "MetaSVM_score", "MetaSVM_rankscore", "MetaSVM_pred", "MetaLR_score", "MetaLR_rankscore", "MetaLR_pred", "M-CAP_score", "M-CAP_rankscore", "M-CAP_pred", "REVEL_score", "REVEL_rankscore", "MutPred_score", "MutPred_rankscore", "CADD_raw", "CADD_raw_rankscore", "CADD_phred", "DANN_score", "DANN_rankscore", "fathmm-MKL_coding_score", "fathmm-MKL_coding_rankscore", "fathmm-MKL_coding_pred", "Eigen_coding_or_noncoding", "Eigen-raw", "Eigen-PC-raw", "GenoCanyon_score", "GenoCanyon_score_rankscore", "integrated_fitCons_score", "integrated_fitCons_score_rankscore", "integrated_confidence_value", "GERP++_RS", "GERP++_RS_rankscore", "phyloP100way_vertebrate", "phyloP100way_vertebrate_rankscore", "phyloP20way_mammalian", "phyloP20way_mammalian_rankscore", "phastCons100way_vertebrate", "phastCons100way_vertebrate_rankscore", "phastCons20way_mammalian", "phastCons20way_mammalian_rankscore", "SiPhy_29way_logOdds", "SiPhy_29way_logOdds_rankscore", "Interpro_domain", "GTEx_V6p_gene", "GTEx_V6p_tissue", "avsnp150", "CLNALLELEID", "CLNDN", "CLNDISDB", "CLNREVSTAT", "CLNSIG", "dbscSNV_ADA_SCORE", "dbscSNV_RF_SCORE", "GME_AF", "GME_NWA", "GME_NEA", "GME_AP", "GME_Israel", "GME_SD", "GME_TP", "GME_CA", "regsnp_fpr", "regsnp_disease", "regsnp_splicing_site", "cosmic89_coding", "cosmic89_noncoding", "info", "genotype", "allelic_depth","ref_depth", "alt_depth")
View(testmaf)
#Convert Annovar fields to VCF
testmaf <- annovarToMaf(input_txt)
input_txt <- "xab"
input_genes <- "predisposition-genes.txt"
#Convert Annovar fields to VCF
testmaf <- annovarToMaf(input_txt)
input_txt <- "xaa"
input_genes <- "predisposition-genes.txt"
#Convert Annovar fields to VCF
testmaf <- annovarToMaf(input_txt)
colnames(testmaf) <- make.unique(names(testmaf))
rm(test)
View(testmaf)
rm(afilter)
rm(all)
rm(clinvar)
rm(fathmmfilter)
rm(intervar)
rm(lrtfilter)
rm(mcapfilter)
rm(merged)
rm(metadata)
#Calculate Allele Fraction
testmaf <-separate(testmaf, V190 ,sep=":", c("genotype","allelic_depth","read_depth2","genotype_quality","phred_likelihoods"))
testmaf <- separate(testmaf, allelic_depth, sep= "," , c("refnum", "altnum"), remove = F)
rm(pbtahist)
rm(participantfilt)
View(testmaf)
